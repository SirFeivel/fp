<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FloorPlanner</title>
  </head>
  <body>
    <header class="topbar">
      <div>
        <div class="title" data-i18n="app.title">FloorPlanner ‚Äì Phase 3 (Tiles + Muster)</div>
        <div class="subtitle" data-i18n="app.subtitle">
          SVG-Vorschau ‚Ä¢ Drag&Drop Ausschl√ºsse ‚Ä¢ Tiles: Grid + Running Bond
        </div>
      </div>
      <div style="display: flex; gap: 12px; align-items: center;">
        <div class="undo-controls">
          <button id="btnUndo" class="btn-icon" title="Undo (Ctrl+Z)" data-i18n-title="undo.undo">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 7v6h6"/>
              <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"/>
            </svg>
          </button>
          <button id="btnRedo" class="btn-icon" title="Redo (Ctrl+Y)" data-i18n-title="undo.redo">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 7v6h-6"/>
              <path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"/>
            </svg>
          </button>
          <span class="undo-counter" id="undoCounter">0 / 0</span>
        </div>
        <div class="field" style="margin: 0;">
          <label data-i18n="language.select" style="margin-right: 8px;">Sprache:</label>
          <select id="langSelect" style="padding: 4px 8px;">
            <option value="de" data-i18n="language.german">Deutsch</option>
            <option value="en" data-i18n="language.english">English</option>
          </select>
        </div>
        <div class="badge" data-i18n="app.autosave">Autosave: AN</div>
      </div>
    </header>

    <main class="layout">
      <section class="panel panel-nav">
        <div class="panel-header">
          <button class="btn-collapse" id="collapseNav" title="Toggle Navigation">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
          </button>
        </div>
        <nav class="tabs">
          <button class="tab" data-tab="room">
            <span class="tab-icon">üìê</span>
            <span data-i18n="room.title">Raum</span>
          </button>
          <button class="tab" data-tab="tiles">
            <span class="tab-icon">üî≤</span>
            <span data-i18n="tile.title">Fliesen</span>
          </button>
          <button class="tab" data-tab="exclusions">
            <span class="tab-icon">‚õî</span>
            <span data-i18n="exclusions.title">Ausschl√ºsse</span>
          </button>
          <button class="tab" data-tab="project">
            <span class="tab-icon">üíæ</span>
            <span data-i18n="project.title">Projekt</span>
          </button>
          <button class="tab" data-tab="debug">
            <span class="tab-icon">üêõ</span>
            <span data-i18n="debug.title">Debug</span>
          </button>
        </nav>

        <div class="tab-content">
          <!-- Room Tab -->
          <div class="tab-panel" data-tab-panel="room">
            <div class="section-card">
              <h3 class="section-title" data-i18n="structure.title">Struktur</h3>
              <div class="grid2">
                <div class="field span2">
                  <label data-i18n="structure.floor">Etage</label>
                  <select id="floorSelect"></select>
                </div>
                <div class="field span2">
                  <label data-i18n="structure.floorName">Etagenname</label>
                  <input id="floorName" type="text" />
                </div>
              </div>
              <div class="btnrow">
                <button id="btnAddFloor" class="btn" data-i18n="structure.addFloor">Etage hinzuf√ºgen</button>
                <button id="btnDeleteFloor" class="btn" data-i18n="structure.deleteFloor">Etage l√∂schen</button>
              </div>
              <div class="grid2" style="margin-top: 1rem;">
                <div class="field span2">
                  <label data-i18n="structure.room">Raum</label>
                  <select id="roomSelect"></select>
                </div>
              </div>
              <div class="btnrow">
                <button id="btnAddRoom" class="btn" data-i18n="structure.addRoom">Raum hinzuf√ºgen</button>
                <button id="btnDeleteRoom" class="btn" data-i18n="structure.deleteRoom">Raum l√∂schen</button>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="room.title">Raum Details</h3>
              <div class="grid2">
                <div class="field span2">
                  <label data-i18n="room.name">Raumname</label>
                  <input id="roomName" type="text" />
                </div>
                <div class="field">
                  <label data-i18n="room.width">Breite (cm)</label>
                  <input id="roomW" type="number" min="0" step="0.1" />
                </div>
                <div class="field">
                  <label data-i18n="room.height">L√§nge (cm)</label>
                  <input id="roomH" type="number" min="0" step="0.1" />
                </div>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="room.sectionDisplay">Anzeige</h3>
              <label class="inline">
                <input id="showGrid" type="checkbox" />
                <span data-i18n="room.showGrid">Hilfsraster anzeigen</span>
              </label>
            </div>
          </div>

          <!-- Tiles & Pattern Tab -->
          <div class="tab-panel" data-tab-panel="tiles">
            <div class="section-card">
              <h3 class="section-title" data-i18n="tile.sectionTiles">Fliesen & Fuge</h3>
              <div class="grid2">
                <div class="field">
                  <label data-i18n="tile.width">Fliese Breite (cm)</label>
                  <input id="tileW" type="number" min="0" step="0.1" />
                </div>
                <div class="field">
                  <label data-i18n="tile.height">Fliese L√§nge (cm)</label>
                  <input id="tileH" type="number" min="0" step="0.1" />
                </div>
                <div class="field">
                  <label data-i18n="tile.grout">Fuge (cm)</label>
                  <input id="groutW" type="number" min="0" step="0.1" />
                </div>
                <div class="field">
                  <label data-i18n="waste.kerfWidth">Schnittbreite (cm)</label>
                  <input id="wasteKerfCm" type="number" min="0" step="0.1" value="0" />
                </div>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="tile.sectionPattern">Muster</h3>
              <div class="grid2">
                <div class="field">
                  <label data-i18n="tile.pattern">Muster</label>
                  <select id="patternType">
                    <option value="grid" data-i18n="tile.patternGrid">Grid</option>
                    <option value="runningBond" data-i18n="tile.patternRunningBond">Running Bond</option>
                  </select>
                </div>
                <div class="field">
                  <label data-i18n="tile.bondFraction">Running Bond Anteil</label>
                  <select id="bondFraction">
                    <option value="0.5">1/2</option>
                    <option value="0.3333333333">1/3</option>
                    <option value="0.25">1/4</option>
                  </select>
                </div>
                <div class="field">
                  <label data-i18n="tile.rotation">Rotation (¬∞)</label>
                  <select id="rotationDeg">
                    <option value="0">0</option>
                    <option value="45">45</option>
                    <option value="90">90</option>
                    <option value="135">135</option>
                    <option value="180">180</option>
                    <option value="225">225</option>
                    <option value="270">270</option>
                    <option value="315">315</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="tile.sectionPosition">Position & Offset</h3>
              <div class="grid2">
                <div class="field">
                  <label data-i18n="origin.preset">Startpunkt Preset</label>
                  <select id="originPreset">
                    <option value="tl" data-i18n="origin.presetTL">oben links</option>
                    <option value="tr" data-i18n="origin.presetTR">oben rechts</option>
                    <option value="bl" data-i18n="origin.presetBL">unten links</option>
                    <option value="br" data-i18n="origin.presetBR">unten rechts</option>
                    <option value="center" data-i18n="origin.presetCenter">Mitte</option>
                    <option value="free" data-i18n="origin.presetFree">frei</option>
                  </select>
                </div>
                <div class="field">
                  <label data-i18n="origin.x">Startpunkt X (cm)</label>
                  <input id="originX" type="number" step="1" />
                </div>
                <div class="field">
                  <label data-i18n="origin.y">Startpunkt Y (cm)</label>
                  <input id="originY" type="number" step="1" />
                </div>
                <div class="field">
                  <label data-i18n="tile.offsetX">Offset X (cm)</label>
                  <input id="offsetX" type="number" step="1" />
                </div>
                <div class="field">
                  <label data-i18n="tile.offsetY">Offset Y (cm)</label>
                  <input id="offsetY" type="number" step="1" />
                </div>
                <div class="btnrow span2">
                  <button id="btnOffLeft" class="btn small">‚Üê 1cm</button>
                  <button id="btnOffRight" class="btn small">‚Üí 1cm</button>
                  <button id="btnOffUp" class="btn small">‚Üë 1cm</button>
                  <button id="btnOffDown" class="btn small">‚Üì 1cm</button>
                </div>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="tile.sectionPricing">Preis & Verschnitt</h3>
              <div class="grid2">
                <div class="field">
                  <label data-i18n="pricing.pricePerM2">Preis pro m¬≤ (‚Ç¨)</label>
                  <input id="pricePerM2" type="number" step="0.01" min="0" />
                </div>
                <div class="field">
                  <label data-i18n="pricing.packSize">Packungsgr√∂√üe (m¬≤)</label>
                  <input id="packM2" type="number" step="0.01" min="0" />
                </div>
                <div class="field">
                  <label data-i18n="pricing.reserve">Reserve (Fliesen)</label>
                  <input id="reserveTiles" type="number" step="1" min="0" />
                </div>
                <label class="chk span2">
                  <input id="wasteAllowRotate" type="checkbox" checked />
                  <span data-i18n="waste.allowRotate">Restst√ºcke drehen (Reuse)</span>
                </label>
                <label class="chk span2">
                  <input id="wasteOptimizeCuts" type="checkbox" />
                  <span data-i18n="waste.optimizeCuts">Verschnitt optimieren</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Exclusions Tab -->
          <div class="tab-panel" data-tab-panel="exclusions">
            <div class="section-card">
              <h3 class="section-title" data-i18n="exclusions.title">Ausschlussbereiche</h3>
              <div class="btnrow">
                <button id="btnAddRect" class="btn" data-i18n="exclusions.addRect">+ Rechteck</button>
                <button id="btnAddCircle" class="btn" data-i18n="exclusions.addCircle">+ Kreis</button>
                <button id="btnAddTri" class="btn" data-i18n="exclusions.addTriangle">+ Dreieck</button>
              </div>
              <div class="grid2" style="margin-top: 10px">
                <div class="field span2">
                  <label data-i18n="exclusions.list">Liste</label>
                  <select id="exclList" size="6"></select>
                </div>
              </div>
              <div class="btnrow" style="margin-top: 10px">
                <button id="btnDeleteExcl" class="btn danger" data-i18n="exclusions.delete">L√∂schen</button>
              </div>
              <div class="meta subtle" style="margin-top: 10px" data-i18n="exclusions.dragHint">
                Drag im Plan verschiebt die Auswahl
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="exclusions.properties">Eigenschaften</h3>
              <div id="exclProps" class="grid2">
                <div class="meta subtle span2" data-i18n="exclusions.noneSelected">‚Äì nichts ausgew√§hlt ‚Äì</div>
              </div>
            </div>
          </div>

          <!-- Project Tab -->
          <div class="tab-panel" data-tab-panel="project">
            <div class="section-card">
              <h3 class="section-title" data-i18n="session.title">Session</h3>
              <div class="btnrow">
                <button id="btnReset" class="btn" data-i18n="session.reset">Reset</button>
                <button id="btnLoadSession" class="btn" data-i18n="session.restore">Session laden</button>
              </div>
              <div class="meta" style="margin-top: 10px">
                <div><span class="k" data-i18n="session.status">Session:</span> <span id="sessionStatus">‚Äì</span></div>
                <div><span class="k" data-i18n="session.lastSaved">Gespeichert:</span> <span id="lastSaved">‚Äì</span></div>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="project.title">Projekt speichern</h3>
              <div class="grid2">
                <div class="field span2">
                  <label data-i18n="project.nameLabel">Projektname</label>
                  <input id="projectName" type="text" data-i18n-placeholder="project.namePlaceholder" placeholder="z.B. Bad EG" />
                </div>
                <div class="field span2">
                  <button id="btnSaveProject" class="btn primary" data-i18n="project.save">Projekt speichern</button>
                </div>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="project.savedProjects">Gespeicherte Projekte</h3>
              <div class="grid2">
                <div class="field span2">
                  <label data-i18n="project.savedProjects">Projekte</label>
                  <select id="projectSelect"></select>
                </div>
                <div class="btnrow span2">
                  <button id="btnLoadProject" class="btn" data-i18n="project.load">Laden</button>
                  <button id="btnDeleteProject" class="btn danger" data-i18n="project.delete">L√∂schen</button>
                </div>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="undo.history">History</h3>
              <div class="meta">
                <div><span class="k" data-i18n="undo.lastAction">Aktion:</span> <span id="lastAction">‚Äì</span></div>
                <div>
                  <span class="k" data-i18n="undo.undoCount">Undo:</span> <span id="undoCount">0</span> ‚Ä¢
                  <span class="k" data-i18n="undo.redoCount">Redo:</span> <span id="redoCount">0</span>
                </div>
              </div>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="importExport.title">Import / Export</h3>
              <div class="btnrow">
                <button id="btnExport" class="btn" data-i18n="importExport.export">Export JSON</button>
                <button id="btnImport" class="btn" data-i18n="importExport.import">Import JSON</button>
                <input id="fileImport" type="file" accept="application/json" style="display: none;" />
              </div>
              <div class="meta subtle" style="margin-top: 10px" data-i18n="importExport.hint">
                Import ist undo-bar
              </div>
            </div>
          </div>

          <!-- Debug Tab -->
          <div class="tab-panel" data-tab-panel="debug">
            <div class="section-card">
              <h3 class="section-title" data-i18n="debug.sectionOptions">Debug Optionen</h3>
              <label class="chk">
                <input id="debugShowNeeds" type="checkbox" />
                <span data-i18n="debug.showNeeds">Restst√ºck-Bedarf anzeigen</span>
              </label>
            </div>

            <div class="section-card">
              <h3 class="section-title" data-i18n="state.title">Live State</h3>
              <button id="btnCopy" class="btn small" data-i18n="importExport.copy" style="margin-bottom: 8px;">Copy State</button>
              <pre id="stateView" class="code">‚Äì</pre>
            </div>
          </div>
        </div>
      </section>

      <div class="resize-handle"></div>

      <section class="viewer">
        <div class="viewerHead">
          <h2 data-i18n="warnings.title">Warnungen</h2>
          <div class="pill" id="warnPill">0</div>
        </div>
        <div id="warnings" class="warnings"></div>

        <div class="viewerHead">
          <h2 data-i18n="plan.title">Plan (SVG)</h2>
          <div class="btnrow">
            <button id="btnFullscreen" class="btn small" title="Fullscreen View">‚õ∂</button>
          </div>
        </div>

        <div class="svgWrap">
          <svg id="planSvg" xmlns="http://www.w3.org/2000/svg"></svg>
          <div class="hintline" data-i18n="plan.hint">
            Tipp: Klick w√§hlt aus ‚Ä¢ Drag verschiebt
          </div>
        </div>
      </section>

      <div class="resize-handle"></div>

      <section class="panel panel-info">
        <div class="panel-header">
          <h3 class="section-title" data-i18n="metrics.title">Berechnung</h3>
          <button class="btn-collapse" id="collapseInfo" title="Toggle Info">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
          </button>
        </div>
        <div id="metrics" class="metrics-panel">
          <div class="metric-grid">
            <div class="metric-item">
              <div class="metric-label" data-i18n="metrics.netArea">Fl√§che:</div>
              <div class="metric-value" id="metricArea">‚Äì</div>
            </div>
            <div class="metric-item">
              <div class="metric-label" data-i18n="metrics.totalTiles">Fliesen:</div>
              <div class="metric-value" id="metricTiles">‚Äì</div>
            </div>
            <div class="metric-item">
              <div class="metric-label" data-i18n="metrics.tilePacks">Tile Packs:</div>
              <div class="metric-value" id="metricPacks">‚Äì</div>
            </div>
            <div class="metric-item">
              <div class="metric-label" data-i18n="metrics.price">Kosten:</div>
              <div class="metric-value" id="metricCost">‚Äì</div>
            </div>
            <div class="metric-item">
              <div class="metric-label" data-i18n="metrics.cutTiles">Cut tiles:</div>
              <div class="metric-value" id="metricCutTiles">‚Äì</div>
            </div>
            <div class="metric-item">
              <div class="metric-label" data-i18n="metrics.waste">Waste (purchase):</div>
              <div class="metric-value" id="metricWaste">‚Äì</div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>