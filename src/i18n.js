const translations = {
  de: {
    app: {
      title: "TilePerfect [ALPHA]",
      subtitle: "Professional Tile Layout Planner",
      autosave: "Autosave"
    },
    nav: {
      setup: "Einrichtung",
      planning: "Planung",
      commercial: "Kosten"
    },
    setup: {
      projectTitle: "Projekt",
      projectOpenExistingTitle: "Bestehendes Projekt öffnen",
      projectSaveNewTitle: "Neues Projekt speichern",
      floorTitle: "Etage",
      roomTitle: "Raum",
      tileCollection: "Fliesenkollektion",
      tilePresets: "Fliesen-Presets",
      skirtingPresets: "Sockelleisten-Presets",
      presetName: "Name",
      presetDeleteInUseTitle: "Preset wird verwendet",
      presetDeleteConfirm: "Preset löschen",
      presetDeleteCancel: "Abbrechen",
      assignRooms: "Räumen zuweisen",
      useForSkirting: "Als Sockelleiste (Zuschnitt) verwenden",
      width: "Breite (cm)",
      length: "Länge (cm)",
      complexRoomHint: "Benötigen Sie eine L-Form oder einen komplexen Raum?",
      continuePlanning: "Weiter zur Planung"
    },
    planning: {
      tile: "Fliese:",
      settings: "Raumeinstellungen",
      editTileConfig: "Bearbeiten",
      done: "Fertig",
      floorView: "Etage",
      patternGroups: "Gruppen",
      roomView: "Raum",
      tileEditActionsTitle: "Änderungen speichern",
      tileEditUpdatePreset: "Preset aktualisieren",
      tileEditSaveNew: "Als neues Preset speichern",
      tileEditSaveCreate: "Speichern",
      tileEditDiscard: "Verwerfen",
      tileEditUpdateWarnTitle: "Betrifft alle Räume",
      tileEditUpdateWarnText: "Das Aktualisieren dieses Presets verändert jeden Raum, der es verwendet.",
      tileEditNewLabel: "Neuer Preset-Name",
      tileEditCreate: "Erstellen",
      tileEditCancel: "Abbrechen",
      tileEditInvalidDims: "Bitte gültige Fliesenmaße eingeben.",
      tileEditInvalidPrice: "Preis- und Packwerte müssen 0 oder größer sein.",
      tileEditDuplicateName: "Name existiert bereits. Bitte einen neuen Namen wählen.",
      tileEditSwitchBlocked: "Bitte Änderungen speichern oder verwerfen, bevor du ein anderes Preset wählst.",
      tileEditPromptExisting: "Fliesen geändert. Eingeben: update (Preset aktualisieren), new (neues Preset) oder discard (verwerfen).",
      tileEditPromptNew: "Fliesen geändert. Eingeben: new (neues Preset) oder discard (verwerfen).",
      advanced: "Erweitert (Ursprung & Offset)",
      displayOptions: "Anzeigeoptionen",
      showGrid: "Rasterlinien anzeigen",
      showSkirting: "Sockelleisten anzeigen",
      removalMode: "Entfernungsmodus"
    },
    floor: {
      uploadBg: "Bild",
      calibrate: "Kalibrieren",
      opacity: "Deckkraft:",
      linkPatterns: "Muster verbinden",
      shareOffcuts: "Verschnitt teilen",
      calibratePrompt: "Länge eingeben (cm):",
      calibrateSuccess: "Kalibrierung erfolgreich",
      calibrateStep: "Schritt {n}/{total}",
      calibrateDrawLine: "Klicken Sie zwei Punkte auf einer bekannten Strecke",
      calibrateEnterLength: "Länge eingeben (cm):",
      calibrateConfirm: "Bestätigen",
      calibrateMeasurement: "Messung {n}: {cm} cm",
      calibrateComplete: "Kalibrierung abgeschlossen!",
      calibrateDone: "Fertig",
      calibrateScale: "Maßstab: 1 cm = {px} px",
      noBackground: "Kein Hintergrundbild",
      hintDragRooms: "Räume ziehen zum Positionieren • Doppelklick zum Bearbeiten",
      addRoom: "Raum hinzufügen",
      addRectRoom: "Rechteck",
      drawRoom: "Freiform",
      deleteRoom: "Löschen",
      cannotDeleteLastRoom: "Der letzte Raum kann nicht gelöscht werden",
      disconnectedRoomsWarning: "Warnung: Einige Räume sind nicht verbunden!\n\nRäume müssen mindestens 10cm Wand teilen, um als verbunden zu gelten.\n\nMöchten Sie trotzdem fortfahren?",
      tilesToggled: "Fliesenanzeige umgeschaltet",
      showTiles: "Fliesen anzeigen"
    },
    view: {
      switchedToFloor: "Etagenansicht",
      switchedToRoom: "Raumansicht",
      switchedToPatternGroups: "Mustergruppen"
    },
    patternGroups: {
      selectRoom: "Raum auswählen",
      roomIndependent: "Raum ist unabhängig",
      roomIsOrigin: "Ursprungsraum",
      roomInGroup: "In Gruppe mit",
      created: "Mustergruppe erstellt",
      roomAdded: "Raum zur Gruppe hinzugefügt",
      roomRemoved: "Raum aus Gruppe entfernt",
      dissolved: "Mustergruppe aufgelöst",
      originChanged: "Ursprungsraum geändert",
      dissolveConfirm: "Die Mustergruppe wird aufgelöst. Alle Räume werden unabhängig. Fortfahren?",
      removeDisconnectWarning: "Das Entfernen dieses Raums trennt auch: {rooms}. Fortfahren?",
      origin: "⊙ Ursprung",
      member: "◦ Mitglied",
      selectedGroup: "Ausgewählte Gruppe",
      noGroups: "Keine Gruppen",
      groupSelected: "Gruppe ausgewählt"
    },
    settings: {
      save: "Projekt speichern",
      load: "Projekt laden",
      export: "JSON exportieren",
      import: "JSON importieren",
      reset: "Alles zurücksetzen",
      debug: "Debug-Panel"
    },
    session: {
      title: "Gefahrenzone",
      reset: "Alles zurücksetzen",
      confirmReset: "Sind Sie sicher? Alle Änderungen am aktuellen Projekt gehen verloren!",
      restore: "Letzten Stand wiederherstellen (Session)",
      status: "Session-Status:",
      lastSaved: "Zuletzt gespeichert:",
      present: "vorhanden"
    },
    project: {
      tabTitle: "Einstellungen",
      title: "Projekt speichern",
      namePlaceholder: "z.B. Bad EG",
      nameLabel: "Name für lokales Speichern",
      save: "Lokal Speichern",
      savedProjects: "Laden",
      load: "Projekt laden",
      delete: "Projekt löschen",
      deleteConfirmTitle: "Projekt löschen?",
      deleteConfirmText: "Dieses gespeicherte Projekt wird aus diesem Browser entfernt.",
      deleteConfirm: "Projekt löschen",
      deleteCancel: "Abbrechen",
      changed: "Projekt geändert",
      saved: "Projekt gespeichert",
      loaded: "Projekt geladen",
      deleted: "Projekt gelöscht",
      notFound: "Projekt nicht gefunden.",
      none: "– keine –"
    },
    removal: {
      mode: "Entfernen-Modus",
      modeToggled: "Entfernen-Modus gewechselt",
      tileToggled: "Fliesen-Ausschluss geändert",
      skirtToggled: "Sockelleisten-Ausschluss geändert"
    },
    tabs: {
      title: "Gebäude",
      floor: "Etage",
      room: "Raum",
      addFloor: "Etage hinzufügen",
      deleteFloor: "Etage löschen",
      floorName: "Etagenname",
      addRoom: "Raum hinzufügen",
      deleteRoom: "Raum löschen",
      floorAdded: "Etage hinzugefügt",
      floorDeleted: "Etage gelöscht",
      floorChanged: "Etage geändert",
      roomAdded: "Raum hinzugefügt",
      roomDeleted: "Raum gelöscht",
      commercial: "Kommerziell"
    },
    room: {
      title: "Ihr Projekt",
      sectionTitle: "Fläche",
      sectionDisplay: "Anzeige",
      name: "Raumname",
      width: "Breite (cm)",
      height: "Länge (cm)",
      showGrid: "Hilfsraster anzeigen",
      changed: "Raum geändert",
      patternLinkingChanged: "Musterverknüpfung geändert",
      viewChanged: "Ansicht geändert",
      legacyHint: "Legacy: Einzelnes Rechteck. Nutzen Sie Abschnitte für komplexe Formen.",
      sections: "Raum-Abschnitte (L/T/U-Formen)",
      sectionsHint: "Fügen Sie mehrere Abschnitte hinzu, um nicht-rechteckige Räume zu erstellen",
      addSection: "+ Abschnitt hinzufügen",
      sectionsList: "Abschnitte",
      deleteSection: "Abschnitt löschen",
      sectionProps: "Abschnitt-Eigenschaften",
      section: "Abschnitt",
      noSectionSelected: "– kein Abschnitt ausgewählt –",
      sectionAdded: "Abschnitt hinzugefügt",
      sectionDeleted: "Abschnitt gelöscht",
      sectionChanged: "Abschnitt geändert",
      selected: "Raum ausgewählt",
      positionChanged: "Raumposition geändert",
      sizeChanged: "Raumgröße geändert",
      vertexMoved: "Eckpunkt verschoben",
      nameChanged: "Raumname geändert",
      edgeChanged: "Kantenlänge geändert",
      newRoom: "Neuer Raum",
      added: "Raum hinzugefügt",
      deleted: "Raum gelöscht"
    },
    skirting: {
      title: "Sockelleisten Konfiguration",
      preset: "Preset",
      applyPreset: "Preset anwenden",
      presetAdded: "Preset hinzugefügt",
      presetDeleted: "Preset gelöscht",
      presetChanged: "Preset geändert",
      type: "Art der Sockelleiste",
      typeCutout: "Selbst geschnitten (aus Fliesen)",
      typeBought: "Fertig gekauft (Stück)",
      roomEnabled: "Sockelleisten für diesen Raum",
      sectionEnabled: "Sockelleisten für diesen Abschnitt",
      enabled: "Sockelleisten aktiviert",
      wholeRoom: "Gesamter Raum",
      cutoutNotAllowedTitle: "Sockelleiste nur fertig gekauft",
      cutoutNotAllowedText: "Zuschnitt ist deaktiviert. Aktivieren Sie \"Als Sockelleiste verwenden\" im Setup → Fliesenkollektion.",
      height: "Höhe Sockelleiste (cm)",
      boughtWidth: "Länge pro Stück (cm)",
      pricePerPiece: "Preis pro Stück (€)",
      showSkirting: "Sockelleisten in Vorschau anzeigen",
      changed: "Sockelleisten geändert",
      totalLength: "Gesamtlänge (cm)",
      pieces: "Stückzahl",
      additionalTiles: "Zusätzliche Fliesen",
      stripsPerTile: "Streifen / Fliese",
      cost: "Sockelleistenkosten"
    },
    secProps: {
      label: "Bezeichnung",
      x: "X (cm)",
      y: "Y (cm)",
      width: "Breite (cm)",
      height: "Höhe (cm)"
    },
    tile: {
      title: "Fliesen",
      sectionTiles: "Fliesen",
      sectionGrout: "Fugen",
      sectionPattern: "Muster",
      sectionPosition: "Position & Offset",
      sectionPricing: "Fliesenhandling",
      sectionLayout: "Fliesen Layout",
      preset: "Preset",
      createPreset: "Preset erstellen",
      presetEmptyHint: "Erstelle zuerst ein Fliesen-Preset, um zu starten.",
      custom: "Benutzerdefiniert",
      applyPreset: "Preset anwenden",
      presetAdded: "Preset hinzugefügt",
      presetDeleted: "Preset gelöscht",
      presetChanged: "Preset geändert",
      presetDeleteWarn: "Dieses Preset wird in",
      presetDeleteWarnTail: "Räumen verwendet. Beim Löschen werden die Fliesen in diesen Räumen zurückgesetzt. Fortfahren?",
      shape: "Fliesenform",
      shapeRect: "Rechteckig",
      shapeSquare: "Quadratisch",
      shapeHex: "Sechseckig",
      shapeRhombus: "Raute",
      reference: "Referenz / Name",
      width: "Fliese Breite (cm)",
      height: "Fliese Länge (cm)",
      hexHint: "Bei Sechsecken: Breite = Flach-zu-Flach-Abstand. Höhe wird automatisch berechnet.",
      grout: "Fuge",
      groutColor: "Fugenfarbe",
      pattern: "Muster",
      patternGrid: "Grid",
      patternRunningBond: "Running Bond",
      patternHerringbone: "Fischgrätmuster",
      patternDoubleHerringbone: "Doppeltes Fischgrätmuster",
      patternBasketweave: "Flechtmuster",
      patternVerticalStackAlternating: "Vertikaler Verband (alternierend)",
      bondFraction: "Running Bond Anteil",
      rotation: "Rotation (°)",
      offsetX: "Offset X (cm)",
      offsetY: "Offset Y (cm)",
      changed: "Parameter geändert",
      patternChanged: "Muster geändert",
      offsetChanged: "Offset geändert"
    },
    pricing: {
      title: "Preis",
      pricePerM2: "Preis pro m² (€)",
      packSize: "Packungsgröße (m²)",
      pricePerPack: "Preis pro Pack (€)",
      reserve: "Reserve (Fliesen)"
    },
    waste: {
      allowRotate: "Reststücke drehen (Reuse)",
      shareOffcuts: "Verschnitt raumübergreifend teilen",
      optimizeCuts: "Verschnitt optimieren (Zuschnitt erlaubt)",
      kerfWidth: "Schnittbreite / Kerf (mm)",
      changed: "Reuse geändert",
      optimizeChanged: "Verschnitt-Optimierung geändert"
    },
    origin: {
      preset: "Startpunkt Preset",
      presetTL: "oben links",
      presetTR: "oben rechts",
      presetBL: "unten links",
      presetBR: "unten rechts",
      presetCenter: "Mitte",
      presetFree: "frei",
      x: "Startpunkt X (cm) (nur frei)",
      y: "Startpunkt Y (cm) (nur frei)"
    },
    exclusions: {
      title: "Ausschlussbereiche",
      advanced: "Erweitert",
      addRect: "+ Rechteck",
      addCircle: "+ Kreis",
      addTriangle: "+ Dreieck",
      delete: "Löschen",
      list: "Liste",
      dragHint: "Drag im Plan verschiebt die Auswahl. Commit erst bei Drag-Ende.",
      properties: "Eigenschaften (Auswahl)",
      noneSelected: "– nichts ausgewählt –",
      label: "Bezeichnung",
      added: "Ausschluss hinzugefügt",
      deleted: "Ausschluss gelöscht",
      changed: "Ausschluss geändert",
      moved: "Ausschluss verschoben",
      resized: "Ausschluss geändert",
      rect: "Rechteck",
      circle: "Kreis",
      triangle: "Dreieck",
      outside: "Ausschluss außerhalb Raum"
    },
    exclProps: {
      x: "X (cm)",
      y: "Y (cm)",
      width: "Breite (cm)",
      height: "Höhe (cm)",
      centerX: "Mitte X (cm)",
      centerY: "Mitte Y (cm)",
      radius: "Radius (cm)",
      p1x: "P1 X (cm)",
      p1y: "P1 Y (cm)",
      p2x: "P2 X (cm)",
      p2y: "P2 Y (cm)",
      p3x: "P3 X (cm)",
      p3y: "P3 Y (cm)"
    },
    undo: {
      title: "Undo / Redo",
      history: "Verlauf",
      undo: "Undo",
      redo: "Redo",
      lastAction: "Letzte Aktion:",
      undoCount: "Undo:",
      redoCount: "Redo:"
    },
    importExport: {
      title: "Import / Export",
      export: "Export JSON",
      import: "Import JSON",
      copy: "Copy State",
      hint: "Import ist undo-bar. Projekt speichern/laden nicht.",
      importFailed: "Import fehlgeschlagen: JSON nicht lesbar.",
      importRejected: "Import abgelehnt (Errors):",
      stateCopied: "State kopiert.",
      copyFailed: "Copy fehlgeschlagen (Clipboard nicht verfügbar)."
    },
    warnings: {
      title: "Hinweise",
      none: "Keine Hinweise",
      validationOk: "Validierung ok.",
      error: "Muster kann nicht angezeigt werden",
      warn: "Warnung",
      warningsTitle: "Warnungen",
      tipsTitle: "Tipps",
      tip: "Tipp",
      noTips: "Keine Tipps"
    },
    validation: {
      noRoomSelected: "Kein Raum ausgewählt",
      selectRoom: "Bitte wählen Sie einen Raum aus.",
      roomWidthInvalid: "Raumbreite ungültig",
      roomWidthText: "Muss eine positive Zahl > 0 sein.",
      roomHeightInvalid: "Raumlänge ungültig",
      roomHeightText: "Muss eine positive Zahl > 0 sein.",
      tilePresetMissingTitle: "Kein Fliesen-Preset",
      tilePresetMissingText: "Bitte zuerst ein Fliesen-Preset erstellen, bevor du planst.",
      tileWidthInvalid: "Fliesenbreite ungültig",
      tileWidthText: "Muss eine positive Zahl > 0 sein.",
      tileHeightInvalid: "Fliesenlänge ungültig",
      tileHeightText: "Muss eine positive Zahl > 0 sein.",
      groutInvalid: "Fuge ungültig",
      groutText: "Muss eine Zahl ≥ 0 sein.",
      herringboneRatioTitle: "Herringbone Verhältnis ungültig",
      herringboneRatioText: "Für Fischgrätmuster muss die lange Seite genau in die kurze Seite passen (z. B. 2:1, 3:1). Aktuelles Verhältnis:",
      doubleHerringboneRatioTitle: "Double Herringbone Verhältnis ungültig",
      doubleHerringboneRatioText: "Für Double Herringbone muss die lange Seite genau in das Doppelte der kurzen Seite passen (z. B. 4:1, 6:1). Aktuelles Verhältnis:",
      basketweaveRatioTitle: "Basketweave Verhältnis ungültig",
      basketweaveRatioText: "Für Basketweave muss die lange Seite genau in die kurze Seite passen (z. B. 2:1, 3:1). Aktuelles Verhältnis:",
      rotationWarning: "Rotation außerhalb 45° Raster",
      rotationText: "MVP: 0..315 in 45°-Schritten.",
      invalid: "ist ungültig.",
      exclOutside: "liegt teilweise außerhalb.",
      currentValue: "Aktueller Wert:",
      disconnectedRoomsTitle: "Nicht verbundene Räume",
      disconnectedRoomsText: "Einige Räume sind nicht verbunden. Räume müssen mindestens 10cm Wand teilen."
    },
    metrics: {
      title: "Berechnung",
      totalTiles: "Fliesen gesamt:",
      fullTiles: "Fliesen (voll):",
      cutTiles: "Fliesen (Schnitt):",
      reusedCuts: "Wiederverwendet (Cuts):",
      allowRotate: "Drehen erlaubt:",
      optimizeCuts: "Verschnitt optimieren:",
      waste: "Verschnitt (Einkauf):",
      netArea: "Fläche (Netto):",
      tilePacks: "Packungen:",
      price: "Preis:",
      cutWork: "Beschnitt (Aufwand):",
      yes: "Ja",
      no: "Nein",
      grandTotal: "Gesamtsumme (Inkl. Sockelleisten)",
      totalTilesToOrder: "Fliesen gesamt:",
      totalPacksToOrder: "Packungen gesamt:",
      totalCostToOrder: "Gesamtkosten:",
      projectSummary: "Projekt-Zusammenfassung",
      rooms: "Räume",
      totalArea: "Fläche gesamt:"
    },
    commercial: {
      title: "Kaufmännische Übersicht",
      rooms: "Raumübersicht",
      materials: "Zusammengefasste Materialien",
      export: "Export Übersicht",
      pricePerM2: "Preis / m²",
      pricePerPack: "Preis / Paket",
      packSize: "Paket (m²)",
      totalM2: "Fläche m²",
      totalPacks: "Pakete",
      packsFloor: "Pakete Boden",
      packsSkirting: "Pakete Sockelleisten",
      floorTiles: "Bodenfliesen",
      skirtingTiles: "Sockelleistenfliesen",
      tileAreaM2: "Fliesenfläche (m²)",
      skirtingCostBought: "Sockelleisten (gekauft)",
      totalCost: "Kosten",
      amountOverride: "Menge +/-",
      totalTiles: "Fliesen gesamt",
      grandTotal: "GESAMT",
      defaultMaterial: "Standard",
    },
    export: {
      tab: "Export",
      roomPlans: "Raumpläne (PDF)",
      commercial: "Kaufmännische Übersicht",
      selectAll: "Alle auswählen",
      clear: "Auswahl aufheben",
      pageSize: "Seitengröße",
      orientation: "Ausrichtung",
      portrait: "Hochformat",
      landscape: "Querformat",
      scale: "Maßstab",
      fitToPage: "An Seite anpassen",
      includeGrid: "Raster einblenden",
      includeSkirting: "Sockelleisten einblenden",
      includeExclusions: "Aussparungen einblenden",
      includeLegend: "Legende einblenden",
      includeMetrics: "Maße einblenden",
      notes: "Anmerkungen",
      exportPdf: "PDF exportieren",
      exportRoomsPdf: "Raumpläne als PDF",
      exportCommercialPdf: "Übersicht als PDF",
      exportXlsx: "Excel exportieren",
      exporting: "Exportiere...",
      exportingRoom: "Exportiere Raum {0} von {1}",
      success: "Export abgeschlossen",
      error: "Export fehlgeschlagen",
      noRoomsSelected: "Keine Räume ausgewählt",
      noTileConfigured: "Keine Fliese konfiguriert",
      plansTitle: "Raumpläne",
      commercialTitle: "Kaufmännisch",
      intro: "Einführung",
      introTitle: "Excel-Übersicht – Hinweise",
      introProject: "Projekt",
      introDate: "Datum",
      introGenerated: "Erstellt mit",
      introOverview: "Diese Datei enthält berechnete Tabellen für Räume, Materialien und Sockelleisten.",
      introAssumptions: "Grundlage der Berechnungen: Nettofläche pro Raum (ohne Zuschnittflächen), Preise pro m², Packungsgröße in m².",
      introRooms: "Räume: Pakete werden aus Nettfläche berechnet. Sockelleistenkosten werden addiert (gekauft: Stückpreis; Zuschnitt: Fliesenbedarf).",
      introMaterials: "Materialien: Aggregation über alle Räume pro Referenz. Zusatzpakete werden addiert.",
      introSkirting: "Sockelleisten: Zeigt Länge, Stückzahl und Kosten je Raum. Zuschnitt nutzt zusätzliche Fliesen.",
      introSummary: "Übersicht: Summen basieren auf den Materialtabellen (inkl. Sockelleisten).",
      introNotes: "Hinweis: Alle Summenfelder sind Excel-Formeln. Änderungen an Eingabewerten aktualisieren die Ergebnisse.",
      summary: "Übersicht",
      materials: "Materialien",
      rooms: "Räume",
      skirting: "Sockelleisten",
      selectionChanged: "Export-Auswahl geändert",
      legendExclusion: "Ausschnitt",
      legendRemovedTile: "Entfernte Fliese",
      legendRemovedSkirting: "Entfernte Sockelleiste",
      legendStartPoint: "Startpunkt"
    },
    pdf: {
      projectName: "Projekt",
      floor: "Etage",
      room: "Raum",
      dimensions: "Abmessungen",
      area: "Fläche",
      tile: "Fliese",
      tileDetails: "Fliesen-Details",
      pattern: "Muster",
      grout: "Fuge",
      color: "Farbe",
      origin: "Ursprung",
      rotation: "Rotation",
      offset: "Versatz",
      layoutDetails: "Layout-Details",
      skirtingPieces: "Sockelleistenstücke",
      skirting: "Sockelleiste",
      legend: "Legende",
      generatedBy: "Erstellt mit TilePerfect",
      company: "Firma",
      address: "Adresse",
      contact: "Kontakt",
      notes: "Notizen"
    },
    plan: {
      title: "Plan (SVG)",
      hintTitle: "Tipp",
      hint: "Klick wählt aus • Drag verschiebt • Tiles kommen aus Fliesen & Muster"
    },
    state: {
      title: "Live State (read-only)"
    },
    debug: {
      title: "Debug",
      sectionOptions: "Debug Optionen",
      showNeeds: "Reststück-Bedarf anzeigen",
      changed: "Debug geändert"
    },
    init: {
      withSession: "Init (Session)",
      default: "Init"
    },
    errors: {
      renderFailed: "Fehler: Rendering fehlgeschlagen",
      reloadPage: "Bitte Seite neu laden.",
      noSession: "Keine gültige Session gefunden.",
      sessionRestored: "Letzten Stand wiederhergestellt",
      autosaveFailed: "Automatisches Speichern fehlgeschlagen",
      importFailed: "Import fehlgeschlagen",
      exportFailed: "Export fehlgeschlagen",
      geometryError: "Geometrie-Berechnungsfehler"
    },
    language: {
      select: "Sprache:",
      german: "Deutsch",
      english: "English"
    },
    dialog: {
      confirm: "Bestätigen",
      cancel: "Abbrechen",
      ok: "OK",
      yes: "Ja",
      no: "Nein",
      save: "Speichern",
      delete: "Löschen",
      close: "Schließen",
      reset: "Zurücksetzen",
      continue: "Fortfahren",
      warning: "Warnung",
      error: "Fehler",
      success: "Erfolg",
      info: "Information",
      selectProject: "Projekt auswählen",
      enterProjectName: "Projektname eingeben",
      noProjectsAvailable: "Keine Projekte verfügbar",
      cannotDeleteLastFloor: "Die letzte Etage kann nicht gelöscht werden",
      cannotDeleteLastRoom: "Der letzte Raum kann nicht gelöscht werden",
      confirmResetTitle: "Alles zurücksetzen?",
      confirmResetText: "Alle Änderungen am aktuellen Projekt gehen verloren. Diese Aktion kann nicht rückgängig gemacht werden.",
      importFailedTitle: "Import fehlgeschlagen",
      importRejectedTitle: "Import abgelehnt",
      copiedToClipboard: "In Zwischenablage kopiert",
      copyFailed: "Kopieren fehlgeschlagen",
      noSessionTitle: "Keine Session",
      noSessionText: "Keine gültige Session zum Wiederherstellen gefunden.",
      projectNotFoundTitle: "Nicht gefunden",
      projectNotFoundText: "Das ausgewählte Projekt konnte nicht gefunden werden.",
      uploadFailedTitle: "Upload fehlgeschlagen",
      disconnectedRoomsTitle: "Nicht verbundene Räume",
      dissolveGroupTitle: "Gruppe auflösen?",
      removeFromGroupTitle: "Raum entfernen?"
    }
  },
  en: {
    app: {
      title: "TilePerfect [ALPHA]",
      subtitle: "Professional Tile Layout Planner",
      autosave: "Autosave"
    },
    nav: {
      setup: "Setup",
      planning: "Planning",
      commercial: "Commercial"
    },
    setup: {
      projectTitle: "Project",
      projectOpenExistingTitle: "Open Existing Project",
      projectSaveNewTitle: "Save New Project",
      floorTitle: "Floor",
      roomTitle: "Room",
      tileCollection: "Tile Collection",
      tilePresets: "Tile Presets",
      skirtingPresets: "Skirting Presets",
      presetName: "Name",
      presetDeleteInUseTitle: "Preset in use",
      presetDeleteConfirm: "Delete preset",
      presetDeleteCancel: "Cancel",
      assignRooms: "Assign to rooms",
      useForSkirting: "Use as skirting (cutout)",
      width: "Width (cm)",
      length: "Length (cm)",
      complexRoomHint: "Need an L-shape or complex room?",
      continuePlanning: "Continue to Planning"
    },
    planning: {
      tile: "Tile:",
      settings: "Room Settings",
      editTileConfig: "Edit",
      done: "Done",
      floorView: "Floor",
      patternGroups: "Groups",
      roomView: "Room",
      tileEditActionsTitle: "Save changes",
      tileEditUpdatePreset: "Update preset",
      tileEditSaveNew: "Save as new",
      tileEditSaveCreate: "Save",
      tileEditDiscard: "Discard",
      tileEditUpdateWarnTitle: "Affects all rooms",
      tileEditUpdateWarnText: "Updating this preset will update every room using it.",
      tileEditNewLabel: "New preset name",
      tileEditCreate: "Create",
      tileEditCancel: "Cancel",
      tileEditInvalidDims: "Please enter valid tile dimensions.",
      tileEditInvalidPrice: "Price and pack values must be 0 or greater.",
      tileEditDuplicateName: "Name already exists. Please choose a new name.",
      tileEditSwitchBlocked: "Please save or discard changes before selecting another preset.",
      tileEditPromptExisting: "Tile changed. Type: update (update preset), new (new preset), or discard.",
      tileEditPromptNew: "Tile changed. Type: new (new preset) or discard.",
      advanced: "Advanced (Origin & Offset)",
      displayOptions: "Display Options",
      showGrid: "Show grid lines",
      showSkirting: "Show skirting",
      removalMode: "Removal mode"
    },
    floor: {
      uploadBg: "Image",
      calibrate: "Calibrate",
      opacity: "Opacity:",
      linkPatterns: "Link patterns",
      shareOffcuts: "Share offcuts",
      calibratePrompt: "Enter length (cm):",
      calibrateSuccess: "Calibration successful",
      calibrateStep: "Step {n}/{total}",
      calibrateDrawLine: "Click two points on a known measurement",
      calibrateEnterLength: "Enter length (cm):",
      calibrateConfirm: "Confirm",
      calibrateMeasurement: "Measurement {n}: {cm} cm",
      calibrateComplete: "Calibration complete!",
      calibrateDone: "Done",
      calibrateScale: "Scale: 1 cm = {px} px",
      noBackground: "No background image",
      hintDragRooms: "Drag rooms to position • Double-click to edit room",
      addRoom: "Add Room",
      addRectRoom: "Rectangle",
      drawRoom: "Freeform",
      deleteRoom: "Delete",
      cannotDeleteLastRoom: "Cannot delete the last room",
      disconnectedRoomsWarning: "Warning: Some rooms are not connected!\n\nRooms must share at least 10cm of wall to be considered connected.\n\nDo you want to continue anyway?",
      tilesToggled: "Floor tiles toggled",
      showTiles: "Show tiles"
    },
    view: {
      switchedToFloor: "Floor view",
      switchedToRoom: "Room view",
      switchedToPatternGroups: "Pattern Groups"
    },
    patternGroups: {
      selectRoom: "Select a room",
      roomIndependent: "Room is independent",
      roomIsOrigin: "Origin room",
      roomInGroup: "In group with",
      created: "Pattern group created",
      roomAdded: "Room added to group",
      roomRemoved: "Room removed from group",
      dissolved: "Pattern group dissolved",
      originChanged: "Origin room changed",
      dissolveConfirm: "This will dissolve the pattern group. All rooms will become independent. Continue?",
      removeDisconnectWarning: "Removing this room will also disconnect: {rooms}. Continue?",
      origin: "⊙ Origin",
      member: "◦ Member",
      selectedGroup: "Selected Group",
      noGroups: "No groups",
      groupSelected: "Group selected"
    },
    settings: {
      save: "Save Project",
      load: "Load Project",
      export: "Export JSON",
      import: "Import JSON",
      reset: "Reset All",
      debug: "Debug Panel"
    },
    session: {
      title: "Danger Zone",
      reset: "Reset All",
      confirmReset: "Are you sure? All changes to the current project will be lost!",
      restore: "Restore Last Session",
      status: "Session Status:",
      lastSaved: "Last Saved:",
      present: "present"
    },
    project: {
      tabTitle: "Settings",
      title: "Save Project",
      namePlaceholder: "e.g. Bathroom Ground Floor",
      nameLabel: "Project Name",
      save: "Save Locally",
      savedProjects: "Load",
      load: "Load Project",
      delete: "Delete Project",
      deleteConfirmTitle: "Delete project?",
      deleteConfirmText: "This will remove the saved project from this browser.",
      deleteConfirm: "Delete project",
      deleteCancel: "Cancel",
      changed: "Project changed",
      saved: "Project saved",
      loaded: "Project loaded",
      deleted: "Project deleted",
      notFound: "Project not found.",
      none: "– none –"
    },
    removal: {
      mode: "Removal Mode",
      modeToggled: "Removal mode toggled",
      tileToggled: "Tile exclusion toggled",
      skirtToggled: "Skirting exclusion toggled"
    },
    tabs: {
      title: "Building",
      floor: "Floor",
      room: "Room",
      addFloor: "Add Floor",
      deleteFloor: "Delete Floor",
      floorName: "Floor Name",
      addRoom: "Add Room",
      deleteRoom: "Delete Room",
      floorAdded: "Floor added",
      floorDeleted: "Floor deleted",
      floorChanged: "Floor changed",
      roomAdded: "Room added",
      roomDeleted: "Room deleted",
      commercial: "Commercial"
    },
    room: {
      title: "Your Project",
      sectionTitle: "Area",
      sectionDisplay: "Display",
      name: "Room Name",
      width: "Width (cm)",
      height: "Length (cm)",
      showGrid: "Show Grid",
      changed: "Room changed",
      patternLinkingChanged: "Pattern linking changed",
      viewChanged: "View changed",
      legacyHint: "Legacy: Single rectangle. Use sections below for complex shapes.",
      sections: "Room Sections (L/T/U shapes)",
      sectionsHint: "Add multiple sections to create non-rectangular rooms",
      addSection: "+ Add Section",
      sectionsList: "Sections",
      deleteSection: "Delete Section",
      sectionProps: "Section Properties",
      section: "Section",
      noSectionSelected: "– no section selected –",
      sectionAdded: "Section added",
      sectionDeleted: "Section deleted",
      sectionChanged: "Section changed",
      selected: "Room selected",
      positionChanged: "Room position changed",
      sizeChanged: "Room size changed",
      vertexMoved: "Vertex moved",
      nameChanged: "Room name changed",
      edgeChanged: "Edge length changed",
      newRoom: "New Room",
      added: "Room added",
      deleted: "Room deleted"
    },
    skirting: {
      title: "Skirting Configuration",
      preset: "Preset",
      applyPreset: "Apply Preset",
      presetAdded: "Preset added",
      presetDeleted: "Preset deleted",
      presetChanged: "Preset changed",
      type: "Type of skirting",
      typeCutout: "Self-made (cut from tiles)",
      typeBought: "Ready-made (per piece)",
      roomEnabled: "Skirting for this room",
      sectionEnabled: "Skirting for this section",
      enabled: "Skirting enabled",
      wholeRoom: "Whole room",
      cutoutNotAllowedTitle: "Skirting must be store-bought",
      cutoutNotAllowedText: "Cutout is disabled. Enable \"Use as skirting\" in Setup → Tile Collection.",
      height: "Skirting height (cm)",
      boughtWidth: "Length per piece (cm)",
      pricePerPiece: "Price per piece (€)",
      showSkirting: "Show skirting in preview",
      changed: "Skirting changed",
      totalLength: "Total length (cm)",
      pieces: "Pieces (qty)",
      additionalTiles: "Sacrificed tiles (qty)",
      stripsPerTile: "Strips / Tile",
      cost: "Skirting cost"
    },
    secProps: {
      label: "Label",
      x: "X (cm)",
      y: "Y (cm)",
      width: "Width (cm)",
      height: "Height (cm)"
    },
    tile: {
      title: "Tiles",
      sectionTiles: "Tiles",
      sectionGrout: "Grout",
      sectionPattern: "Pattern",
      sectionPosition: "Position & Offset",
      sectionPricing: "Handling Tiles",
      sectionLayout: "Tile Layout",
      preset: "Preset",
      createPreset: "Create preset",
      presetEmptyHint: "Create a tile preset to get started.",
      custom: "Custom",
      applyPreset: "Apply Preset",
      presetAdded: "Preset added",
      presetDeleted: "Preset deleted",
      presetChanged: "Preset changed",
      presetDeleteWarn: "This preset is used in",
      presetDeleteWarnTail: "rooms. Deleting it will clear tiles in those rooms. Continue?",
      shape: "Tile Shape",
      shapeRect: "Rectangular",
      shapeSquare: "Square",
      shapeHex: "Hexagonal",
      shapeRhombus: "Rhombus",
      reference: "Reference / Name",
      width: "Tile Width (cm)",
      height: "Tile Height (cm)",
      hexHint: "For hexagons: width = flat-to-flat distance. Height is auto-calculated.",
      grout: "Grout",
      groutColor: "Grout Color",
      pattern: "Pattern",
      patternGrid: "Grid",
      patternRunningBond: "Running Bond",
      patternHerringbone: "Herringbone",
      patternDoubleHerringbone: "Double Herringbone",
      patternBasketweave: "Basketweave",
      patternVerticalStackAlternating: "Vertical Stack Alternating",
      bondFraction: "Running Bond Fraction",
      rotation: "Rotation (°)",
      offsetX: "Offset X (cm)",
      offsetY: "Offset Y (cm)",
      changed: "Parameters changed",
      patternChanged: "Pattern changed",
      offsetChanged: "Offset changed"
    },
    pricing: {
      title: "Pricing",
      pricePerM2: "Price per m² (€)",
      packSize: "Pack Size (m²)",
      pricePerPack: "Price per pack (€)",
      reserve: "Reserve (tiles)"
    },
    waste: {
      allowRotate: "Rotate leftovers (Reuse)",
      shareOffcuts: "Share offcuts across rooms",
      optimizeCuts: "Optimize waste (allow cutting)",
      kerfWidth: "Kerf Width (mm)",
      changed: "Reuse changed",
      optimizeChanged: "Waste optimization changed"
    },
    origin: {
      preset: "Origin Preset",
      presetTL: "top left",
      presetTR: "top right",
      presetBL: "bottom left",
      presetBR: "bottom right",
      presetCenter: "center",
      presetFree: "free",
      x: "Origin X (cm) (free only)",
      y: "Origin Y (cm) (free only)"
    },
    exclusions: {
      title: "Exclusion Areas",
      advanced: "Advanced",
      addRect: "+ Rectangle",
      addCircle: "+ Circle",
      addTriangle: "+ Triangle",
      delete: "Delete",
      list: "List",
      dragHint: "Drag in plan moves selection. Commits on drag end.",
      properties: "Properties (Selection)",
      noneSelected: "– nothing selected –",
      label: "Label",
      added: "Exclusion added",
      deleted: "Exclusion deleted",
      changed: "Exclusion changed",
      moved: "Exclusion moved",
      resized: "Exclusion resized",
      rect: "Rectangle",
      circle: "Circle",
      triangle: "Triangle",
      outside: "Exclusion outside room"
    },
    exclProps: {
      x: "X (cm)",
      y: "Y (cm)",
      width: "Width (cm)",
      height: "Height (cm)",
      centerX: "Center X (cm)",
      centerY: "Center Y (cm)",
      radius: "Radius (cm)",
      p1x: "P1 X (cm)",
      p1y: "P1 Y (cm)",
      p2x: "P2 X (cm)",
      p2y: "P2 Y (cm)",
      p3x: "P3 X (cm)",
      p3y: "P3 Y (cm)"
    },
    undo: {
      title: "Undo / Redo",
      history: "History",
      undo: "Undo",
      redo: "Redo",
      lastAction: "Last Action:",
      undoCount: "Undo:",
      redoCount: "Redo:"
    },
    importExport: {
      title: "Import / Export",
      export: "Export JSON",
      import: "Import JSON",
      copy: "Copy State",
      hint: "Import is undo-able. Project save/load is not.",
      importFailed: "Import failed: JSON not readable.",
      importRejected: "Import rejected (Errors):",
      stateCopied: "State copied.",
      copyFailed: "Copy failed (Clipboard not available)."
    },
    warnings: {
      title: "Warnings",
      none: "No warnings",
      validationOk: "Validation OK.",
      error: "Can't display pattern",
      warn: "Warning",
      warningsTitle: "Warnings",
      tipsTitle: "Tips",
      tip: "Tip",
      noTips: "No tips"
    },
    validation: {
      noRoomSelected: "No room selected",
      selectRoom: "Please select a room.",
      roomWidthInvalid: "Room width invalid",
      roomWidthText: "Must be a positive number > 0.",
      roomHeightInvalid: "Room height invalid",
      roomHeightText: "Must be a positive number > 0.",
      tilePresetMissingTitle: "No tile preset",
      tilePresetMissingText: "Please create a tile preset before planning.",
      tileWidthInvalid: "Tile width invalid",
      tileWidthText: "Must be a positive number > 0.",
      tileHeightInvalid: "Tile height invalid",
      tileHeightText: "Must be a positive number > 0.",
      groutInvalid: "Grout invalid",
      groutText: "Must be a number ≥ 0.",
      herringboneRatioTitle: "Herringbone ratio invalid",
      herringboneRatioText: "For herringbone, the long side must fit perfectly into the short side (e.g., 2:1, 3:1). Current ratio:",
      doubleHerringboneRatioTitle: "Double herringbone ratio invalid",
      doubleHerringboneRatioText: "For double herringbone, the long side must fit perfectly into 2× the short side (e.g., 4:1, 6:1). Current ratio:",
      basketweaveRatioTitle: "Basketweave ratio invalid",
      basketweaveRatioText: "For basketweave, the long side must fit perfectly into the short side (e.g., 2:1, 3:1). Current ratio:",
      rotationWarning: "Rotation outside 45° grid",
      rotationText: "MVP: 0..315 in 45° steps.",
      invalid: "is invalid.",
      exclOutside: "is partially outside.",
      currentValue: "Current value:",
      disconnectedRoomsTitle: "Disconnected Rooms",
      disconnectedRoomsText: "Some rooms are not connected. Rooms must share at least 10cm of wall."
    },
    metrics: {
      title: "Calculation",
      totalTiles: "Total tiles:",
      fullTiles: "Full tiles:",
      cutTiles: "Cut tiles:",
      reusedCuts: "Reused (cuts):",
      allowRotate: "Rotation allowed:",
      optimizeCuts: "Optimize waste:",
      waste: "Waste (purchase):",
      netArea: "Net area:",
      tilePacks: "Tile Packs:",
      price: "Price:",
      cutWork: "Cut work:",
      yes: "Yes",
      no: "No",
      grandTotal: "Grand Total (incl. Skirting)",
      totalTilesToOrder: "Total tiles:",
      totalPacksToOrder: "Total packs:",
      totalCostToOrder: "Total cost:",
      projectSummary: "Project Summary",
      rooms: "Rooms",
      totalArea: "Total Area:"
    },
    commercial: {
      title: "Commercial Overview",
      rooms: "Rooms Overview",
      materials: "Consolidated Materials",
      export: "Export Overview",
      pricePerM2: "Price / m²",
      pricePerPack: "Price / Pack",
      packSize: "Pack Size (m²)",
      totalM2: "Total Area (m²)",
      totalPacks: "Total Packs",
      packsFloor: "Packs (Floor)",
      packsSkirting: "Packs (Skirting)",
      floorTiles: "Floor Tiles",
      skirtingTiles: "Skirting Tiles",
      tileAreaM2: "Tile Area (m²)",
      skirtingCostBought: "Bought Skirting",
      totalCost: "Total Cost",
      amountOverride: "Amount +/-",
      totalTiles: "Total Tiles",
      grandTotal: "TOTAL",
      defaultMaterial: "Default",
    },
    export: {
      tab: "Export",
      roomPlans: "Room Plans (PDF)",
      commercial: "Commercial Summary",
      selectAll: "Select All",
      clear: "Clear",
      pageSize: "Page Size",
      orientation: "Orientation",
      portrait: "Portrait",
      landscape: "Landscape",
      scale: "Scale",
      fitToPage: "Fit to Page",
      includeGrid: "Include Grid",
      includeSkirting: "Include Skirting",
      includeExclusions: "Include Exclusions",
      includeLegend: "Include Legend",
      includeMetrics: "Include Metrics",
      notes: "Notes",
      exportPdf: "Export PDF",
      exportRoomsPdf: "Room Plans PDF",
      exportCommercialPdf: "Commercial PDF",
      exportXlsx: "Export Excel",
      exporting: "Exporting...",
      exportingRoom: "Exporting room {0} of {1}",
      success: "Export complete",
      error: "Export failed",
      noRoomsSelected: "No rooms selected",
      noTileConfigured: "No tile configured",
      plansTitle: "Room Plans",
      commercialTitle: "Commercial",
      intro: "Introduction",
      introTitle: "Excel Summary – Notes",
      introProject: "Project",
      introDate: "Date",
      introGenerated: "Generated by",
      introOverview: "This file contains calculated tables for rooms, materials, and skirting.",
      introAssumptions: "Calculations are based on net area per room, price per m², and pack size in m².",
      introRooms: "Rooms: packs are derived from net area. Skirting costs are added (bought: piece price; cutout: extra tiles).",
      introMaterials: "Materials: aggregated by reference across rooms. Extra packs are added.",
      introSkirting: "Skirting: shows length, piece count, and costs per room. Cutout uses additional tiles.",
      introSummary: "Summary: totals are derived from the materials sheet (including skirting).",
      introNotes: "Note: all totals are Excel formulas. Changing inputs recalculates results.",
      summary: "Summary",
      materials: "Materials",
      rooms: "Rooms",
      skirting: "Skirting",
      selectionChanged: "Export selection changed",
      legendExclusion: "Exclusion",
      legendRemovedTile: "Removed tile",
      legendRemovedSkirting: "Removed skirting",
      legendStartPoint: "Start point"
    },
    pdf: {
      projectName: "Project",
      floor: "Floor",
      room: "Room",
      dimensions: "Dimensions",
      area: "Area",
      tile: "Tile",
      tileDetails: "Tile Details",
      pattern: "Pattern",
      grout: "Grout",
      color: "Color",
      origin: "Origin",
      rotation: "Rotation",
      offset: "Offset",
      layoutDetails: "Layout Details",
      skirtingPieces: "Skirting pieces",
      skirting: "Skirting",
      legend: "Legend",
      generatedBy: "Generated by TilePerfect",
      company: "Company",
      address: "Address",
      contact: "Contact",
      notes: "Notes"
    },
    plan: {
      title: "Plan (SVG)",
      hintTitle: "Tip",
      hint: "Tip: Click selects • Drag moves • Tiles come from Tiles & Pattern"
    },
    state: {
      title: "Live State (read-only)"
    },
    debug: {
      title: "Debug",
      sectionOptions: "Debug Options",
      showNeeds: "Show leftover needs",
      changed: "Debug changed"
    },
    init: {
      withSession: "Init (Session)",
      default: "Init"
    },
    errors: {
      renderFailed: "Error: Rendering failed",
      reloadPage: "Please reload page.",
      noSession: "No valid session found.",
      sessionRestored: "Last state restored",
      autosaveFailed: "Autosave failed",
      importFailed: "Import failed",
      exportFailed: "Export failed",
      geometryError: "Geometry calculation error"
    },
    language: {
      select: "Language:",
      german: "Deutsch",
      english: "English"
    },
    dialog: {
      confirm: "Confirm",
      cancel: "Cancel",
      ok: "OK",
      yes: "Yes",
      no: "No",
      save: "Save",
      delete: "Delete",
      close: "Close",
      reset: "Reset",
      continue: "Continue",
      warning: "Warning",
      error: "Error",
      success: "Success",
      info: "Information",
      selectProject: "Select Project",
      enterProjectName: "Enter project name",
      noProjectsAvailable: "No projects available",
      cannotDeleteLastFloor: "Cannot delete the last floor",
      cannotDeleteLastRoom: "Cannot delete the last room",
      confirmResetTitle: "Reset Everything?",
      confirmResetText: "All changes to the current project will be lost. This action cannot be undone.",
      importFailedTitle: "Import Failed",
      importRejectedTitle: "Import Rejected",
      copiedToClipboard: "Copied to clipboard",
      copyFailed: "Copy failed",
      noSessionTitle: "No Session",
      noSessionText: "No valid session found to restore.",
      projectNotFoundTitle: "Not Found",
      projectNotFoundText: "The selected project could not be found.",
      uploadFailedTitle: "Upload Failed",
      disconnectedRoomsTitle: "Disconnected Rooms",
      dissolveGroupTitle: "Dissolve Group?",
      removeFromGroupTitle: "Remove Room?"
    }
  }
};

let currentLang = "de";

try {
  const isNodeRuntime = typeof process !== "undefined" && process.versions?.node;
  const storage = !isNodeRuntime && typeof document !== "undefined" ? document.defaultView?.localStorage : null;
  if (storage) {
    currentLang = storage.getItem("floorplanner_lang") || "de";
  }
} catch (e) {
  currentLang = "de";
}

export function setLanguage(lang) {
  if (translations[lang]) {
    currentLang = lang;
    try {
      const isNodeRuntime = typeof process !== "undefined" && process.versions?.node;
      const storage = !isNodeRuntime && typeof document !== "undefined" ? document.defaultView?.localStorage : null;
      if (storage) storage.setItem("floorplanner_lang", lang);
    } catch (e) {
      // localStorage not available
    }
  }
}

export function getLanguage() {
  return currentLang;
}

export function t(path) {
  const keys = path.split(".");
  let value = translations[currentLang];

  for (const key of keys) {
    if (value && typeof value === "object") {
      value = value[key];
    } else {
      return path;
    }
  }

  return value || path;
}
